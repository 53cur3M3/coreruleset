---
  meta:
    author: "fzipitria"
    enabled: true
    name: "945100.yaml"
    description: "Description"
  tests:
    -
      test_title: 945100-1
      desc: SSRF - IPV4/IPV6
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://[0:0:0:0:0:ffff:169.254.169.254]"
            output:
              log_contains: id "945100"
    -
      test_title: 945100-2
      desc: SSRF - Dotless decimal
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://2852039166/"
            output:
              log_contains: id "945100"
    -
      test_title: 945100-3
      desc: SSRF - Dotless decimal with overflow
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://7147006462/"
            output:
              log_contains: id "945100"
    -
      test_title: 945100-4
      desc: SSRF - Dotted hexadecimal
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://0xA9.0xFE.0xA9.0xFE/"
            output:
              log_contains: id "945100"

    -
      test_title: 945100-5
      desc: SSRF - Dotless hexadecimal
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://0xA9FEA9FE/"
            output:
              log_contains: id "945100"

    -
      test_title: 945100-6
      desc: SSRF - Dotless hexadecimal
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://0xA9FEA9FE/"
            output:
              log_contains: id "945100"

    -
      test_title: 945100-7
      desc: SSRF - Dotless hexadecimal with overflow
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://0x41414141A9FEA9FE/"
            output:
              log_contains: id "945100"

    -
      test_title: 945100-8
      desc: SSRF - Dotted octal
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://0251.0376.0251.0376/"
            output:
              log_contains: id "945100"
    -
      test_title: 945100-9
      desc: SSRF - Dotted octal
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://0251.0376.0251.0376/"
            output:
              log_contains: id "945100"
    -
      test_title: 945100-10
      desc: SSRF - Dotted octal
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://0251.0376.0251.0376/"
            output:
              log_contains: id "945100"

    -
      test_title: 945100-11
      desc: SSRF - Dotted octal with padding
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://0251.00376.000251.0000376/"
            output:
              log_contains: id "945100"
    -
      test_title: 945100-12
      desc: SSRF - Dotted octal with padding
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://0251.00376.000251.0000376/"
            output:
              log_contains: id "945100"
    -
      test_title: 945100-13
      desc: SSRF - Dotted octal with padding
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://169.254.43518/"
            output:
              log_contains: id "945100"
    -
      test_title: 945100-14
      desc: SSRF - Dotted octal with padding
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://169.16689662/"
            output:
              log_contains: id "945100"
    -
      test_title: 945100-15
      desc: SSRF - IPV6 Compressed
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://[::ffff:a9fe:a9fe]"
            output:
              log_contains: id "945100"
    -
      test_title: 945100-16
      desc: SSRF - IPV6 Expanded
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=http://[0:0:0:0:0:ffff:a9fe:a9fe]"
            output:
              log_contains: id "945100"
    -
      test_title: 945100-17
      desc: SSRF - IPV6 Expanded - Negative tests
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=[0:0:0:0:0:ffff:a9fe:a9fe]"
            output:
              no_log_contains: id "945100"
    -
      test_title: 945100-18
      desc: SSRF - Dotless decimal - Negative tests
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=2852039166"
            output:
              no_log_contains: id "945100"
    -
      test_title: 945100-19
      desc: SSRF - Dotless hexadecimal with overflow - Negative tests
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=0x41414141A9FEA9FE"
            output:
              no_log_contains: id "945100"
    -
      test_title: 945100-20
      desc: SSRF - Negative tests
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=169.16689662"
            output:
              no_log_contains: id "945100"
    -
      test_title: 945100-21
      desc: SSRF - Negative tests - IPV6 Compressed
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=[::ffff:a9fe:a9fe"
            output:
              no_log_contains: id "945100"
    -
      test_title: 945100-21
      desc: SSRF - Negative tests - IPV6 Compressed
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=[0:0:0:0:0:ffff:a9fe:a9fe]"
            output:
              no_log_contains: id "945100"
    -
      test_title: 945100-22
      desc: SSRF - Negative tests - IPV6 Expanded
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=[0:0:0:0:0:ffff:a9fe:a9fe]"
            output:
              no_log_contains: id "945100"
    -
      test_title: 945100-23
      desc: SSRF - Negative tests - IPV6/IPV4
      stages:
        -
          stage:
            input:
              dest_addr: "127.0.0.1"
              port: 80
              headers:
                Host: "localhost"
                User-Agent: "ModSecurity CRS 3 Tests"
                Accept: text/xml,application/xml,application/xhtml+xml,text/html;q=0.9,text/plain;q=0.8,image/png,*/*;q=0.5
                Accept-Charset: ISO-8859-1,utf-8;q=0.7,*;q=0.7
                Accept-Encoding: gzip,deflate
                Accept-Language: en-us,en;q=0.5
              method: GET
              uri: "/test?ssrf=[0:0:0:0:0:ffff:169.254.169.254]"
            output:
              no_log_contains: id "945100"